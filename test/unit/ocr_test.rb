require 'test_helper'

class OCRTest < ActionView::TestCase

  test "jimu" do
    # map = {"captcha0.png"=>"er78", "captcha1.png"=>"ejj8", "captcha2.png"=>"y67w", "captcha3.png"=>"dpa4", "captcha4.png"=>"eftr", "captcha5.png"=>"rw73", "captcha6.png"=>"pjat", "captcha7.png"=>"rtt4", "captcha8.png"=>"3aw6", "captcha9.png"=>"tw84", "captcha10.png"=>"jdma", "captcha11.png"=>"7f47", "captcha12.png"=>"w3wr", "captcha13.png"=>"3gy4", "captcha14.png"=>"68gb", "captcha15.png"=>"bejr", "captcha16.png"=>"pgdy", "captcha17.png"=>"gwy8", "captcha18.png"=>"38a3", "captcha19.png"=>"mgg3", "captcha20.png"=>"geww", "captcha21.png"=>"rnbm", "captcha22.png"=>"r4p3", "captcha23.png"=>"yaey", "captcha24.png"=>"78y7", "captcha25.png"=>"3jmf", "captcha26.png"=>"e7tb", "captcha27.png"=>"b6gb", "captcha28.png"=>"ggmr", "captcha29.png"=>"ej4t", "captcha30.png"=>"ff86", "captcha31.png"=>"bja8", "captcha32.png"=>"rt8i", "captcha33.png"=>"7agf", "captcha34.png"=>"awb4", "captcha35.png"=>"84ri", "captcha36.png"=>"armb", "captcha37.png"=>"rjpb", "captcha38.png"=>"3fd8", "captcha39.png"=>"6wrw", "captcha40.png"=>"fmfw", "captcha41.png"=>"bryg", "captcha42.png"=>"3grr", "captcha43.png"=>"8j4w", "captcha44.png"=>"fpwp", "captcha45.png"=>"aj4e", "captcha46.png"=>"f7et", "captcha47.png"=>"f3ae", "captcha48.png"=>"ta7d", "captcha49.png"=>"gpad", "captcha50.png"=>"bb7y", "captcha51.png"=>"3adr", "captcha52.png"=>"ttda", "captcha53.png"=>"g7ep", "captcha54.png"=>"wadt", "captcha55.png"=>"j7d7", "captcha56.png"=>"pejm", "captcha57.png"=>"gyge", "captcha58.png"=>"dej6", "captcha59.png"=>"bdy8", "captcha60.png"=>"f3wy", "captcha61.png"=>"pgw8", "captcha62.png"=>"e8e7", "captcha63.png"=>"d6mj", "captcha64.png"=>"mw4m", "captcha65.png"=>"7pyp", "captcha66.png"=>"7p7d", "captcha67.png"=>"3gj7", "captcha68.png"=>"3p8a", "captcha69.png"=>"r7w8", "captcha70.png"=>"gdyt", "captcha71.png"=>"rgwr", "captcha72.png"=>"7tr7", "captcha73.png"=>"8dwe", "captcha74.png"=>"mdw4", "captcha75.png"=>"4fb7", "captcha76.png"=>"8efa", "captcha77.png"=>"br7p", "captcha78.png"=>"padf", "captcha79.png"=>"j34f", "captcha80.png"=>"jgja", "captcha81.png"=>"a88e", "captcha82.png"=>"ydtt", "captcha83.png"=>"j7dj", "captcha84.png"=>"eyf6", "captcha85.png"=>"geg7", "captcha86.png"=>"y8pm", "captcha87.png"=>"4at3", "captcha88.png"=>"eyfw", "captcha89.png"=>"tmyd", "captcha90.png"=>"eppy", "captcha91.png"=>"arre", "captcha92.png"=>"tfyp", "captcha93.png"=>"3w8y", "captcha94.png"=>"ge4r", "captcha95.png"=>"3j4t", "captcha96.png"=>"tgrb", "captcha97.png"=>"3fjw", "captcha98.png"=>"8fy3", "captcha99.png"=>"3tre"}
    map = {"captchas0.png"=>"ra6p", "captchas1.png"=>"jt7g", "captchas2.png"=>"p4gg", "captchas3.png"=>"bbr6", "captchas4.png"=>"8f8j", "captchas5.png"=>"g7t6", "captchas6.png"=>"wa3j", "captchas7.png"=>"7af7", "captchas8.png"=>"7aw4", "captchas9.png"=>"ry87", "captchas10.png"=>"ry6w", "captchas11.png"=>"ed6t", "captchas12.png"=>"4tgt", "captchas13.png"=>"gff6", "captchas14.png"=>"yfpa", "captchas15.png"=>"m4a8", "captchas16.png"=>"yt83", "captchas17.png"=>"pewa", "captchas18.png"=>"7mpe", "captchas19.png"=>"yb4r", "captchas20.png"=>"6abt", "captchas21.png"=>"b4ag", "captchas22.png"=>"43er", "captchas23.png"=>"gp6g", "captchas24.png"=>"e73w", "captchas25.png"=>"bbtw", "captchas26.png"=>"wjww", "captchas27.png"=>"b3ag", "captchas28.png"=>"84be", "captchas29.png"=>"dtg4", "captchas30.png"=>"36yt", "captchas31.png"=>"jf6t", "captchas32.png"=>"dy8f", "captchas33.png"=>"gwjw", "captchas34.png"=>"6ejd", "captchas35.png"=>"y3w7", "captchas36.png"=>"pn6r", "captchas37.png"=>"fjwm", "captchas38.png"=>"bbtw", "captchas39.png"=>"d7j8", "captchas40.png"=>"wp87", "captchas41.png"=>"teej", "captchas42.png"=>"rdba", "captchas43.png"=>"68pp", "captchas44.png"=>"74yg", "captchas45.png"=>"4a4b", "captchas46.png"=>"8ggr", "captchas47.png"=>"eyjy", "captchas48.png"=>"8ady", "captchas49.png"=>"ra66", "captchas50.png"=>"tpmj", "captchas51.png"=>"gtmj", "captchas52.png"=>"ryty", "captchas53.png"=>"dw8f", "captchas54.png"=>"ntde", "captchas55.png"=>"tgpy", "captchas56.png"=>"m6yt", "captchas57.png"=>"taa7", "captchas58.png"=>"pgpr", "captchas59.png"=>"egdt", "captchas60.png"=>"e66t", "captchas61.png"=>"r3m6", "captchas62.png"=>"f4r7", "captchas63.png"=>"gpfp", "captchas64.png"=>"g37a", "captchas65.png"=>"tat4", "captchas66.png"=>"rfy7", "captchas67.png"=>"wdf7", "captchas68.png"=>"8ppe", "captchas69.png"=>"fj4w", "captchas70.png"=>"63jb", "captchas71.png"=>"fmpm", "captchas72.png"=>"7erw", "captchas73.png"=>"tgrb", "captchas74.png"=>"wpwy", "captchas75.png"=>"rbmy", "captchas76.png"=>"dwmf", "captchas77.png"=>"8egm", "captchas78.png"=>"jd6f", "captchas79.png"=>"f8ya", "captchas80.png"=>"gg64", "captchas81.png"=>"fdw4", "captchas82.png"=>"aajb", "captchas83.png"=>"jed8", "captchas84.png"=>"6b4p", "captchas85.png"=>"y3r4", "captchas86.png"=>"pmmw", "captchas87.png"=>"y38j", "captchas88.png"=>"7yra", "captchas89.png"=>"b8am", "captchas90.png"=>"bgbd", "captchas91.png"=>"33t4", "captchas92.png"=>"arap", "captchas93.png"=>"wybb", "captchas94.png"=>"efta", "captchas95.png"=>"m8jb", "captchas96.png"=>"raym", "captchas97.png"=>"8yj7", "captchas98.png"=>"rtfa", "captchas99.png"=>"8fyy"}
    new_map = {}
    correct = 0
    map.each do |k, v|
      new_file = "#{Rails.root.to_s}/test/files/captchas/test_#{k}"
      FileUtils.cp("#{Rails.root.to_s}/test/files/captchas/#{k}", new_file)
      ocr = OCR.new(new_file)
      result = ocr.parse
      new_map[k] = result
      # FileUtils.rm(new_file)
      correct += 1 if v == result
    end
    puts new_map.inspect
    puts "#{correct}次正确"
    assert correct > 1
  end
end